import clsx from 'clsx';
import { isEmpty, isNil } from 'lodash';
import { useMemo } from 'react';
import AnimateHeight from 'react-animate-height';
import { FieldErrors } from 'react-hook-form';
import { useTranslation } from 'react-i18next';

type LocalFormErrorProps = {
    errors: FieldErrors<any>;
    className?: string;
}

export const LocalFormError = ({
    errors,
    className,
}: LocalFormErrorProps) => {

    //>────────────────────────────────────────────────────────────────────────────────────────────────<
    //> Contexts                                                                                       <
    //>────────────────────────────────────────────────────────────────────────────────────────────────<

    //>────────────────────────────────────────────────────────────────────────────────────────────────<
    //> State                                                                                          <
    //>────────────────────────────────────────────────────────────────────────────────────────────────<

    //>────────────────────────────────────────────────────────────────────────────────────────────────<
    //> Libs                                                                                           <
    //>────────────────────────────────────────────────────────────────────────────────────────────────<

    // I18n
    const { t } = useTranslation();

    //>────────────────────────────────────────────────────────────────────────────────────────────────<
    //> Queries                                                                                        <
    //>────────────────────────────────────────────────────────────────────────────────────────────────<

    //>────────────────────────────────────────────────────────────────────────────────────────────────<
    //> Getters                                                                                        <
    //>────────────────────────────────────────────────────────────────────────────────────────────────<

    const content = useMemo(() => {
        if (isNil(errors) || isEmpty(errors)) return null;

        return (
            <div
                className={ clsx([
                    'text-center',
                    className,
                ]) }
            >
                <p className='text-error'>{t('local-form-error.invalid-fields')}</p>
            </div>
        );
    }, [errors]);

    //>────────────────────────────────────────────────────────────────────────────────────────────────<
    //> Callbacks                                                                                      <
    //>────────────────────────────────────────────────────────────────────────────────────────────────<

    return (
        <AnimateHeight
            easing='ease-out'
            duration={ 250 }
            height={ content ? 'auto' : 0 }
        >
            {content}
        </AnimateHeight>

    );
};
